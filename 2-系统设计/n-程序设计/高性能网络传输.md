# 高性能网络传输

1. 是什么
   1. 适合业务的I/O模型

2. 为什么
   *  IO 密集型系统大部分时间都在执行 IO 操作，合适的IO模型能提升整体性能

3. I/O的两个阶段

   1. 等待资源阶段

      等待网络传输数据可用，这个过程中我们会对I/O有两种处理方式

      * 阻塞。指的是在数据不可用时，I/O 请求一直阻塞，直到数据返回；
      * 非阻塞。指的是数据不可用时，I/O 请求立即返回，直到被通知资源可用为止。

   2. 使用资源的阶段

      从网络上接收到数据，并且拷贝到应用程序的缓冲区里面，这个阶段我们也会有两种处理方式

      * 同步处理。指的是 I/O 请求在读取或者写入数据时会阻塞，直到读取或者写入数据完成；
      * 异步处理。指的是 I/O 请求在读取或者写入数据时立即返回，当操作系统处理完成 I/O 请求，并且将数据拷贝到用户提供的缓冲区后，再通知应用 I/O 请求执行完成。

4. 常见的五种I/O模型

   两个阶段的处理方式排列组合+扩展

   如果把 I/O 过程比喻成烧水倒水的过程，等待资源（就是烧水的过程），使用资源（就是倒水的过程）

   * 同步阻塞 I/O (BIO)

     站在炤台边上一直等着（等待资源）水烧开，然后倒水（使用资源）

     > 每个连接都需要阻塞一个线程来等待数据，大量的连接数就会需要相同数量的数据接收线程

   * 同步非阻塞 I/O (NIO)

     在烧水的时候躺在沙发上看会儿电视（不再时时刻刻等待资源），但是还是要时不时的去看看水开了没有，一旦水开了，马上去倒水（使用资源）

     > 线程不阻塞，需要多次轮询，线程过多会造成频繁的 CPU 上下文切换

   * 同步多路 I/O 复用(同步非阻塞 I/O扩展)

     同时烧好多壶水，同时在看电视的间隙去看看哪壶水开了（等待多个资源），哪一壶开了就先倒哪一壶（使用资源）

     > 少量的线程就能处理大量的连接，有数据到来的时候时再进行处理
     >
     > 等待线程减少，工作线程根据接收数据情况处理

   * 信号驱动 I/O

     水壶加一个报警器（信号），只要水开了就马上去倒水

   * 异步 I/O (AIO)

     智能水壶，在水烧好后自动就可以把水倒好，并通知你水倒好了

5. 实现

   1. Netty

      > 基于IO多路复用的异步高性能网络框架封装

## 参考资料

* 极客时间-消息队列高手课